<!DOCTYPE html>ï»¿<html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1"><style>body{background-color:#474747;overflow:hidden}label{color:#fff;font-family:sans-serif;font-size:.8em}img{margin-right:4px;cursor:pointer}button{padding:0 4px}#cont{margin-top:4px;overflow-y:scroll;scrollbar-color:#222222 rgba(0,0,0,0.2);scrollbar-width:thin}#cont::-webkit-scrollbar{width:10px;background:rgba(0,0,0,.2)}#cont::-webkit-scrollbar-thumb{background:#222;margin:2px}</style><script>var cont,keyws,imgs=[],hits=[],done=0,UNS=-1!=location.href.indexOf("uns"),PAGE=1,sTop=-1;function update(e){cont=document.getElementById("cont"),keyws=document.getElementById("keyws"),null==e?(PAGE=1,hits=[],sTop=-1):(PAGE=e,sTop=cont.scrollTop);var t,o=keyws.value;document.getElementById("isolated").checked&&(o+=" isolated"),o=o.trim(),console.log(JSON.stringify(o)),t=UNS?"https://api.unsplash.com/search/photos?per_page=30&query="+encodeURIComponent(o)+"&page="+PAGE:"https://pixabay.com/api/?image_type=photo"+(""==o?"":"&q="+encodeURIComponent(o))+"&per_page=100&page="+PAGE+"&key=10554583-a5eacb61c2e61105fdfb6eb88&safesearch=true";var n="gallery"+(UNS?"1":"");""==o&&(t=!UNS&&Math.random()<.005?"gallery.php?url="+encodeURIComponent(t)+"&fnam="+n:n+".json"),console.log(t);var i=new XMLHttpRequest;i.open("GET",t,!0),UNS&&i.setRequestHeader("Authorization","Client-ID 3twt3nS_LYzp4nViMBB3tmWU0F-wyHUpgfrG1nIuiYs"),i.onload=imgsLoaded.bind(this),i.onerror=function(e){console.log(e.target.response)},i.send()}function imgsLoaded(e){var t=JSON.parse(e.target.response),o=t.hits?t.hits:t.results;hits=hits.concat(o);var n=window.innerWidth-29;for(cont.setAttribute("style","height:"+(window.innerHeight-42)+"px;");cont.firstChild;)cont.removeChild(cont.firstChild);cont.scrollTop=0;for(var i=[],s=0;s<hits.length;){for(var r=0,a=s;a<hits.length;){var l=(d=hits[a]).previewWidth,c=d.previewHeight;null==l&&(l=d.width,c=d.height);var p=l*(100/c);if(!(a<=s+1||r+p<n))break;r+=p,a++}for(var h=a-s;s<a;)i.push(Math.min(200,(n-4*h)/r*100)),s++}imgs=[];for(s=0;s<hits.length;s++){var d=hits[s],u=document.createElement("img");u.setAttribute("src",d.previewURL?d.previewURL:d.urls.thumb),u.setAttribute("height",i[s]+"px"),u.addEventListener("click",imgClick),cont.appendChild(u),imgs.push(u)}-1!=sTop&&(cont.scrollTop=sTop),cont.appendChild(document.createElement("br"));var g=document.createElement("button");g.onclick=function(e){update(PAGE+1)},g.textContent="Load More",""!=keyws.value&&cont.appendChild(g),console.log(hits)}function imgClick(e){var t=imgs.indexOf(e.currentTarget),o=hits[t];console.log(o);var n=o.largeImageURL;null==n&&(n=o.urls.full);var i='app.open("'+n+'",null,true);';window.parent.postMessage(i,"*")}function msg(e){alert("These images come from www."+(UNS?"Unsplash":"PixaBay")+".com and are free to use for any purpose.")}window.onresize=update</script></head><body onload="update()"><div style="height:22px;overflow:hidden"><button onclick="msg()">?</button> <label>Keywords:</label> <input type="text" id="keyws" onchange="update()" value=""><input type="checkbox" id="isolated" style="vertical-align:middle" onchange="update()"> <label for="isolated">Isolated</label></div><div id="cont"></div></body></html>